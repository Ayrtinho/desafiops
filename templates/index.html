<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Email Classifier App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script>
        function showLoading() {
            document.getElementById('loading').style.display = 'block';
        }

        function updateFileInfo(input) {
            const fileInfo = document.getElementById('file-info');
            if (input.files && input.files.length > 0) {
                const file = input.files[0];
                const fileSize = (file.size / 1024).toFixed(1); // KB
                fileInfo.innerHTML = `üìÑ ${file.name} (${fileSize} KB)`;
                fileInfo.style.color = '#059669';
                fileInfo.style.fontWeight = '600';
            } else {
                fileInfo.innerHTML = 'Nenhum arquivo selecionado';
                fileInfo.style.color = '#6b7280';
                fileInfo.style.fontWeight = '500';
            }
        }
    </script>
</head>
<body>
<div class="container">
    <h2>ü§ñ Classificador de Emails com IA</h2>
    <form method="post" enctype="multipart/form-data" onsubmit="showLoading()">
        <label for="email_file">üìÅ Upload de arquivo:</label>
        <div class="file-upload-container">
            <div class="file-upload-title">Formatos aceitos: (.txt ou .pdf)</div>
            <div class="file-upload-area">
                <div class="file-upload-row">
                    <div class="file-info" id="file-info">Nenhum arquivo selecionado</div>
                    <button type="button" class="select-file-btn-small" onclick="document.getElementById('email_file').click()">
                        Selecionar
                    </button>
                </div>
                <input type="file" id="email_file" name="email_file" accept=".txt,.pdf" style="display: none;" onchange="updateFileInfo(this)">
            </div>
        </div>
        <label>Ou cole o texto do email:</label>
        <textarea name="email_text" rows="6" placeholder="Cole aqui o texto do email..."></textarea>
        <button type="submit">Classificar e Sugerir Resposta</button>
    </form>
    <div id="loading" class="loading" style="display:none;">
        Processando, por favor aguarde...
    </div>
    {% if error %}
        <div class="error">{{ error }}</div>
    {% endif %}
    {% if categoria %}
        <div class="result">
            <strong>Categoria:</strong> {{ categoria }}<br>
            <strong>Resposta sugerida:</strong> {{ resposta }}<br>
            <details>
                <summary>Ver texto do email analisado</summary>
                <pre>{{ email }}</pre>
            </details>
        </div>
    {% endif %}
</div>
</body>
</html>